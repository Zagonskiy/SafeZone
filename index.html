<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, interactive-widget=resizes-content">
    <title>SafeZone | Secure Terminal</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
</head>
<body>

    <div class="device-case" id="main-case">
        <div class="screw tl"></div><div class="screw tr"></div>
        <div class="screw bl"></div><div class="screw br"></div>

        <div class="screen-container">
            
            <div id="auth-screen" class="screen active">
                <div class="logo-area">
                    <h1>SAFE<span class="highlight">ZONE</span></h1>
                    <p class="status">SYSTEM: ONLINE</p>
                </div>
                <form id="login-form">
                    <h2 class="military-title">/// ДОСТУП К ТЕРМИНАЛУ ///</h2>
                    <div class="input-group">
                        <label>ИДЕНТИФИКАТОР</label>
                        <input type="text" id="login-id" placeholder="ПОЧТА / ПОЗЫВНОЙ" required>
                    </div>
                    <div class="input-group">
                        <label>КОД ДОСТУПА</label>
                        <input type="password" id="login-pass" placeholder="******" required>
                    </div>
                    <button type="submit" class="btn-metal">ПОДТВЕРДИТЬ ЛИЧНОСТЬ</button>
                    <p class="switch-mode" id="to-register">>> ЗАПРОСИТЬ НОВЫЙ ДОПУСК</p>
                </form>
                <form id="register-form" style="display: none;">
                    <h2 class="military-title">/// ЗАПРОС ДОПУСКА ///</h2>
                    <div class="input-group">
                        <label>ЛИЧНЫЙ ПОЗЫВНОЙ</label>
                        <input type="text" id="reg-nick" placeholder="COBRA-01" required>
                    </div>
                    <div class="input-group">
                        <label>ЧАСТОТА СВЯЗИ (EMAIL)</label>
                        <input type="email" id="reg-email" placeholder="soldier@base.com" required>
                    </div>
                    <div class="input-group">
                        <label>КОД ДОСТУПА</label>
                        <input type="password" id="reg-pass" placeholder="******" required>
                    </div>
                    <div class="input-group">
                        <label>ПОВТОРИТЬ КОД</label>
                        <input type="password" id="reg-pass-conf" placeholder="******" required>
                    </div>
                    <button type="submit" class="btn-metal danger">ОФОРМИТЬ ДОПУСК</button>
                    <p class="switch-mode" id="to-login"><< ВЕРНУТЬСЯ НА КПП</p>
                </form>
                <div id="error-log" class="console-output"></div>
            </div>

            <div id="app-interface" class="app-interface hidden">
                
                <div id="hq-screen" class="screen-panel side-panel">
                    <header class="top-bar">
                        <div id="my-profile-link" class="profile-link">
                            <img id="my-mini-avatar" src="" class="avatar-mini" style="display:none">
                            <span id="user-display">БОЕЦ: UNKNOWN</span>
                        </div>
                        <button id="logout-btn" class="btn-small">ОТБОЙ</button>
                    </header>
                    
                    <div class="search-panel">
                        <div class="input-wrapper">
                            <input type="text" id="search-nick" placeholder="> ПОИСК ЦЕЛИ..." class="terminal-input" autocomplete="off">
                            <div id="search-indicator" class="typing-indicator"></div>
                            <div id="search-results" class="search-results-area" style="display: none;">
                                <div id="search-list"></div>
                            </div>
                        </div>
                    </div>

                    <div id="chats-container" class="scroll-zone"></div>
                    <div id="empty-state" class="chat-list-empty" style="display: none;">
                        <div class="radar-scan"></div>
                        <p>> ЖДУ СИГНАЛА...</p>
                    </div>
                </div>

                <div id="chat-screen" class="screen-panel main-panel">
                    <header class="top-bar chat-header">
                        <button id="back-btn" class="btn-small mobile-only"><</button>
                        <span id="chat-title">КАНАЛ: НЕ ВЫБРАН</span>
                        <button id="btn-call" class="btn-small btn-phone-call" style="display: none; margin-left: 10px; margin-right: auto;">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>
                            </svg>
                        </button>
                        <button id="btn-toggle-search" class="btn-small" style="margin-left: auto; display: none; padding: 4px 8px; align-items: center; justify-content: center;">
    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M20 20L16.65 16.65" stroke="#33ff33" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        <circle cx="11" cy="11" r="7" stroke="#33ff33" stroke-width="2"/>
        <path d="M11 7V15" stroke="#33ff33" stroke-width="2" stroke-linecap="round"/>
        <path d="M7 11H15" stroke="#33ff33" stroke-width="2" stroke-linecap="round"/>
    </svg>
</button>
<div id="chat-search-bar" class="search-bar-overlay" style="display: none;">
    <input type="text" id="chat-search-input" placeholder="Поиск сообщения..." autocomplete="off">
    <div class="search-nav">
        <span id="search-count">0/0</span>
        <button id="btn-search-up">▲</button>
        <button id="btn-search-down">▼</button>
        <button id="btn-close-search">×</button>
    </div>
</div>
                    </header>
                    
                    <div id="messages-area" class="messages-container">
                        <div class="no-chat-selected"><p>> ВЫБЕРИТЕ ЦЕЛЬ ДЛЯ СВЯЗИ</p></div>
                    </div>

                    <form id="msg-form" class="msg-input-area" style="display: none;">
                        <input type="file" id="chat-img-upload" accept="image/*, video/*" style="display:none">
                        
                        <button type="button" id="btn-attach-img" class="btn-metal btn-icon" style="margin-right:0; border-right:none;">+</button>
                        
                        <input type="text" id="msg-input" placeholder="ШИФРОВКА..." autocomplete="off">
                        
                        <button type="submit" id="btn-send-text" class="btn-metal btn-send" style="display: none;">></button>
                        
                        <button type="button" id="btn-mic-rec" class="btn-metal btn-send">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="white" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 14C13.66 14 15 12.66 15 11V5C15 3.34 13.66 2 12 2C10.34 2 9 3.34 9 5V11C9 12.66 10.34 14 12 14Z"/>
                                <path d="M19 10V11C19 14.87 15.87 18 12 18C8.13 18 5 14.87 5 11V10H3V11C3 15.53 6.39 19.36 10.73 19.91V23H13.27V19.91C17.61 19.36 21 15.53 21 11V10H19Z"/>
                            </svg>
                        </button>
                    </form>

                    <div id="recording-overlay" class="recording-overlay" style="display: none;">
                        <div class="rec-dot-large"></div>
                        <span id="rec-status-text">ЗАПИСЬ...</span>
                    </div>
                </div>
            </div> 
        </div>
    </div>

    <div id="profile-modal" class="modal-overlay">
        <div class="modal-box profile-box">
            <div class="modal-title">/// ЛИЧНОЕ ДОСЬЕ ///</div>
            <div class="profile-avatar-container">
                <img id="profile-img-preview" src="" class="profile-avatar-large">
                <div id="avatar-placeholder" class="avatar-placeholder">НЕТ ФОТО</div>
                <input type="file" id="avatar-upload" accept="image/*" style="display: none;">
                <button id="btn-upload-avatar" class="btn-small" style="margin-top:5px;">ЗАГРУЗИТЬ ФОТО</button>
            </div>
            <div class="input-group">
                <label>ПОЗЫВНОЙ</label>
                <input type="text" id="profile-nick-input" disabled>
            </div>
            <div class="input-group">
                <label>ХАРАКТЕРИСТИКА (ОПИСАНИЕ)</label>
                <textarea id="profile-desc-input" class="terminal-textarea" placeholder="Нет данных..." disabled></textarea>
            </div>
            <div class="modal-actions">
                <button id="btn-close-profile" class="btn-small">ЗАКРЫТЬ</button>
                <button id="btn-save-profile" class="btn-metal danger" style="display:none">СОХРАНИТЬ ДАННЫЕ</button>
            </div>
        </div>
    </div>

    <div id="custom-modal" class="modal-overlay" style="z-index: 20000;">
        <div class="modal-box">
            <div class="modal-title">/// SYSTEM ALERT ///</div>
            <p id="modal-msg" class="modal-text">MESSAGE TEXT</p>
            <input type="text" id="modal-input-field" placeholder="ВВОД ДАННЫХ...">
            <div class="modal-actions">
                <button id="modal-btn-cancel" class="btn-small">ОТМЕНА</button>
                <button id="modal-btn-confirm" class="btn-metal danger">ПРИНЯТЬ</button>
            </div>
        </div>
    </div>

    <div id="photo-preview-modal" class="modal-overlay" style="z-index: 15000;">
        <div class="modal-box" style="width: 400px; max-width: 90%;">
            <div class="modal-title">/// ПОДТВЕРЖДЕНИЕ ДАННЫХ ///</div>
            
            <div class="preview-container">
                <img id="photo-preview-img" src="" alt="Preview" style="display:none">
                <video id="video-preview-el" controls style="display:none; max-width:100%; max-height:30vh;"></video>
            </div>

            <div class="input-group">
                <label>ПОДПИСЬ К МАТЕРИАЛУ</label>
                <input type="text" id="photo-caption-input" placeholder="Введите описание..." autocomplete="off">
            </div>

            <div class="modal-actions">
                <button id="btn-cancel-photo" class="btn-small">ОТМЕНА</button>
                <button id="btn-confirm-photo" class="btn-metal">ОТПРАВИТЬ</button>
            </div>
        </div>
    </div>
                        
    <div id="image-viewer-modal" class="modal-overlay">
        <span id="close-image-viewer" class="close-btn">&times;</span>
        
        <img class="modal-content-img" id="full-image-view" style="display:none">
        
        <video class="modal-content-img" id="full-video-view" controls playsinline style="display:none"></video>
        
        <div id="image-caption-view" class="caption-text"></div>
    </div>

    <div id="delete-chat-modal" class="modal-overlay" style="z-index: 25000;">
        <div class="modal-box">
            <div class="modal-title" style="color: var(--alert-red); border-color: var(--alert-red);">/// ЛИКВИДАЦИЯ КАНАЛА ///</div>
            <p class="modal-text">ВЫБЕРИТЕ МЕТОД ЗАЧИСТКИ:</p>
            <div class="modal-actions" style="flex-direction: column; gap: 10px;">
                <button id="btn-del-me" class="btn-metal">ТОЛЬКО У МЕНЯ (СКРЫТЬ)</button>
                <button id="btn-del-all" class="btn-metal danger">УНИЧТОЖИТЬ ДЛЯ ВСЕХ</button>
                <button id="btn-del-cancel" class="btn-small">ОТМЕНА</button>
            </div>
        </div>
    </div>

    <audio id="remote-audio" autoplay playsinline style="display:none;"></audio>

<div id="incoming-call-modal" class="modal-overlay" style="z-index: 50000;">
    <div class="modal-box call-box">
        <div class="radar-pulse"></div>
        <div class="modal-title blink-text">/// ВХОДЯЩАЯ СВЯЗЬ ///</div>
        <div class="call-avatar-container">
            <img id="incoming-call-avatar" src="" class="call-avatar">
        </div>
        <h3 id="incoming-caller-name">UNKNOWN</h3>
        <p>ЗАПРАШИВАЕТ ГОЛОСОВОЙ КАНАЛ</p>
        <div class="modal-actions">
            <button id="btn-decline-call" class="btn-metal danger">ОТКЛОНИТЬ</button>
            <button id="btn-answer-call" class="btn-metal success">ОТВЕТИТЬ</button>
        </div>
    </div>
</div>

<div id="active-call-screen" class="call-screen">
    <div class="call-info-wrapper">
        <div class="signal-bars">
            <div class="bar b1"></div><div class="bar b2"></div><div class="bar b3"></div><div class="bar b4"></div>
        </div>
        <h2 id="call-status-text">СОЕДИНЕНИЕ...</h2>
        <h1 id="call-partner-name">PARTNER</h1>
        <div id="call-timer" class="call-timer">00:00</div>
    </div>

    <div class="call-controls">
        <button id="btn-mic-toggle" class="btn-round">
            <svg width="30" height="30" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path>
                <path d="M19 10v2a7 7 0 0 1-14 0v-2"></path>
                <line x1="12" y1="19" x2="12" y2="23"></line>
                <line x1="8" y1="23" x2="16" y2="23"></line>
            </svg>
        </button>
        
        <button id="btn-hangup" class="btn-round red">
            <svg width="30" height="30" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                <path d="M10.68 13.31a16 16 0 0 0 3.41 2.6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7 2 2 0 0 1 1.72 2v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.42 19.42 0 0 1-3.33-2.67m-2.67-3.34a19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91"></path>
                <line x1="23" y1="1" x2="1" y2="23"></line>
            </svg>
        </button>
    </div>
</div>

                        
    <script type="module" src="app.js"></script>
</body>
</html>
